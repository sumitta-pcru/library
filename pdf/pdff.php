<?php

require('pdf/fpdf.php');
$objConnect = mysql_connect("localhost","root","") or die("Error Connect to Database");
$objDB = mysql_select_db("db_book");
@mysql_query("SET NAMES UTF8");
$strSQL = "SELECT * FROM bookreturn";
$objQuery = mysql_query($strSQL);



class PDF extends FPDF
{

    function Header()
    {
        parent::Header(); // TODO: Change the autogenerated stub
        $this->AddFont('angsana','','angsa.php');
        $this->SetFont('angsana','',12);
        $this->SetLeftMargin(10);
        $this->Cell(0,5,iconv("UTF-8","TIS-620",'โรงเรียนวังโป่งศึกษา '),0,1);
        $this->Cell(0,5,iconv("UTF-8","TIS-620",'14 หมู่ 13 ตำบลวังโป่ง อำเภอวังโป่ง '),0,1);
        $this->Cell(0,5,iconv("UTF-8","TIS-620",'จังหวัดเพชรบูรณ์ 67240 สังกัด สพม.40'),0,1);
        $this->Cell(0,5,iconv("UTF-8","TIS-620",'056 786 435'),0,1);
        $this->SetLeftMargin(5);
    }
    function Footer()
    {
        parent::Footer(); // TODO: Change the autogenerated stub
        $this->SetLineWidth(0,5);
        $this->AddFont('angsana','','angsa.php');
        $this->SetFont('angsana','',10);
        $this->SetY(-12);
        $this->Cell(0,5,iconv("UTF-8","TIS-620",'สรน'),0,1,"L");
        $this->Cell(0,5,iconv("UTF-8","TIS-620",'ฉะ' .date('d').'/'.date('m').'/'.(date('Y')+543).''.date('H:i:s')),0,0,"R");
    }

    function LoadData($file)
    {
        //Read file lines
        $lines=file($file);
        $data=array();
        foreach($lines as $line)
            $data[]=explode(';',chop($line));
        return $data;
    }


//Better table
    function ImprovedTable($header,$data)
    {
        //Column widths
        $w=array(20,30,55,25,25,25);
        //Header
        for($i=0;$i<count($header);$i++)

        $this->Cell($w[$i],7,iconv('UTF-8', 'TIS-620', $header[$i]),1,0,'C');
        $this->Ln();
        //Data

        foreach ($data as $eachResult)
        {
            $this->Cell(20,6,$eachResult["br_id"],1 );
            $this->Cell(30,6,$eachResult["m_id"],1);
            $this->Cell(55,6,$eachResult["br_id"],1);
            $this->Cell(25,6,$eachResult["br_id"],1,0,'C');
            $this->Cell(25,6,number_format($eachResult["br_id"],2),1,0,'R');
            $this->Cell(25,6,number_format($eachResult["br_id"],2),1,0,'R');
            $this->Ln();
        }





        //Closure line
        $this->Cell(array_sum($w),0,'','T');
    }

}

$pdf=new PDF();
//Column titles
$header=array('รหัส','ชื่อ','Email','Country Code','Budget','Used');
//Data loading

//*** Load MySQL Data ***//

//require("ThaiPDF.class.php");

$resultData = array();
for ($i=0;$i<mysql_num_rows($objQuery);$i++) {
    $result = mysql_fetch_array($objQuery);
    array_push($resultData,$result);
}
//************************//
$pdf->AddFont('angsana','','angsa.php');
$pdf->AddFont('angsana','B','angsab.php');
$pdf->AddFont('angsana','I','angsai.php');
$pdf->AddFont('angsana','BI','angsaz.php');
$pdf->SetFont('angsana','',12);
//$pdf->SetFont('Arial','',10);



$pdf->AddPage();

$pdf->Ln(10);
$pdf->ImprovedTable($header,$resultData);


$pdf->Output();
?>
<table class="wrap-box" cellpadding="20" cellspacing="0">
    <tr>
        <td style="width: 45%;"><table class="wrap-signature" cellpadding="2" cellspacing="0">
                <tr>
                    <td>ในนาม</td>
                </tr>
                <tr>
                    <td class="line-signature" colspan="2" style="line-height: 200%;"></td>
                </tr>
                <tr>
                    <td colspan="2">ผู้จ่ายเงิน</td>
                </tr>
                <tr>
                    <td style="width: 20%;">วันที่</td>
                    <td style="width: 80%;" class="line-signature"></td>
                </tr>
            </table>
        </td>

        <td style="width: 10%;"></td>

        <td style="width: 45%;"><table class="wrap-signature" cellpadding="2" cellspacing="0">
                <tr>
                    <td>ในนาม </td>
                </tr>
                <tr>
                    <td class="line-signature" colspan="2" style="line-height: 200%;"></td>
                </tr>
                <tr>
                    <td colspan="2">ผู้รับเงิน</td>
                </tr>
                <tr>
                    <td style="width: 20%;">วันที่</td>
                    <td style="width: 80%;" class="line-signature"></td>
                </tr>
            </table>
        </td>
    </tr>
</table>
